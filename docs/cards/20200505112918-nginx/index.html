
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.4">
    
    
      
        <title>nginx - David's Brain Dump</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bb3983ee.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ef5552">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7CSource+Sans+Pro&display=fallback">
        <style>:root{--md-text-font:"";--md-code-font:"Source Sans Pro"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nginx" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="David&#39;s Brain Dump" class="md-header__button md-logo" aria-label="David's Brain Dump" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            David's Brain Dump
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              nginx
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="David&#39;s Brain Dump" class="md-nav__button md-logo" aria-label="David's Brain Dump" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    David's Brain Dump
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Why?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../todo/" class="md-nav__link">
        TOOD List
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Blog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Blog" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/20200502171331-first_blog_ticket/" class="md-nav__link">
        First blog ticket
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/20210329211501-clojure_how_to_get_started/" class="md-nav__link">
        How to get started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/20220103-how_i_solve_problems/" class="md-nav__link">
        Methods to Solve Real Life Problems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Decks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Decks" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Decks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../decks/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../decks/clojure/" class="md-nav__link">
        Clojure
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cards
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cards" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cards
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430141226-life_in_dynamic_typing/" class="md-nav__link">
        Life In Dynamic Typing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430141609-david_nolen/" class="md-nav__link">
        David Nolen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430153912-ethz/" class="md-nav__link">
        ETHZ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430154352-cli_arguments/" class="md-nav__link">
        CLI Arguments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430154528-multiple_environment/" class="md-nav__link">
        Multiple environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430154647-shadow_cljs/" class="md-nav__link">
        shadow-cljs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430155438-mastering_clojure_macro/" class="md-nav__link">
        Mastering Clojure Macro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430155637-applied_clojure/" class="md-nav__link">
        Applied Clojure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430155819-core_async/" class="md-nav__link">
        core.async
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430160432-clojure_for_the_brave_and_the_true/" class="md-nav__link">
        Clojure for the brave and the true
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430180442-org_mode/" class="md-nav__link">
        Org mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430190921-design/" class="md-nav__link">
        Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200430235013-specs/" class="md-nav__link">
        Specs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200501163355-goals/" class="md-nav__link">
        Goals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200501201607-quotes/" class="md-nav__link">
        Quotes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200502122138-simple_made_easy/" class="md-nav__link">
        Simple Made Easy and Simplicity Matters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200503165952-materiala/" class="md-nav__link">
        Materiala
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200503222619-org_roam_clj/" class="md-nav__link">
        org-roam-clj
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200504204808-why_clojure/" class="md-nav__link">
        Why Clojure?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200504212017-edn_and_transit/" class="md-nav__link">
        edn and transit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200504213118-effective_programs_10_years_of_clojure/" class="md-nav__link">
        Effective Programs - 10 years of clojure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200504213225-rich_hickey/" class="md-nav__link">
        Rich Hickey
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505093126-multipass/" class="md-nav__link">
        Multipass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505093245-ansible/" class="md-nav__link">
        Ansible
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505111243-learning_tips/" class="md-nav__link">
        Learning tips
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505112138-clojure_reducers/" class="md-nav__link">
        Clojure Reducers
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          nginx
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        nginx
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#server-blocks" class="md-nav__link">
    Server blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root-directive" class="md-nav__link">
    Root directive
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-file-distribution-through-alias" class="md-nav__link">
    Static file distribution through alias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-pass" class="md-nav__link">
    Proxy pass
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regex-path" class="md-nav__link">
    Regex path
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-source-folder" class="md-nav__link">
    Multiple source folder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    HTTPS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#websocket" class="md-nav__link">
    Websocket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also-generated" class="md-nav__link">
    See also (generated)
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505113402-high_performance_clojurescript/" class="md-nav__link">
        High Performance Clojurescript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505124708-potemkin/" class="md-nav__link">
        Potemkin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505124946-clj_toolkit/" class="md-nav__link">
        clj-toolkit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505125105-medley/" class="md-nav__link">
        medley
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200505164639-cider/" class="md-nav__link">
        cider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200506224558-enlive/" class="md-nav__link">
        Enlive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200514104809-clojure_debug/" class="md-nav__link">
        Clojure Debug
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200514114627-tools_deps/" class="md-nav__link">
        tools.deps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200516171955-generative_testing/" class="md-nav__link">
        Generative Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200516210112-john_hughes/" class="md-nav__link">
        John Hughes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200517205339-clojure_zippers/" class="md-nav__link">
        Clojure Zippers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200517212936-postmortem/" class="md-nav__link">
        Postmortem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200521223909-computer_science_interview/" class="md-nav__link">
        Computer Science Interview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200521232124-cljss/" class="md-nav__link">
        cljss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200524185034-clojure_functional_programming_principles/" class="md-nav__link">
        Clojure Functional Programming Principles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../202005291001-starting_scripting_clojure/" class="md-nav__link">
        Starting Scripting Clojure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20200823205222-datascript/" class="md-nav__link">
        datascript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201003150521-clojurecuda/" class="md-nav__link">
        ClojureCuda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201003214304-clojurecl/" class="md-nav__link">
        clojurecl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201011155722-jna/" class="md-nav__link">
        JNA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201012113409-micromaster_statistics_and_data_science/" class="md-nav__link">
        20201012113409 micromaster statistics and data science
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201020215418-micromaster_statistics_and_data_science_social_science_and_machine_learning/" class="md-nav__link">
        20201020215418 micromaster statistics and data science social science and machine learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201129163941-kafka/" class="md-nav__link">
        Kafka
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20201220130520-emacs_configuration/" class="md-nav__link">
        Emacs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20210131100641-webapp_testing/" class="md-nav__link">
        Webapp Testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20210409170511-clojure_for_data_science/" class="md-nav__link">
        Clojure Data Science
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20211020-clojureclr/" class="md-nav__link">
        ClojureCLR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20220103-skepticism/" class="md-nav__link">
        Scientific method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20220104113109-how_to_solve_it/" class="md-nav__link">
        How to Solve It
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../20220104115124-bad_science/" class="md-nav__link">
        Bad Science
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../continuing_education/" class="md-nav__link">
        Continuing Education
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cpp/" class="md-nav__link">
        C/C++
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../devops/" class="md-nav__link">
        Docker and Kubernete
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../general/" class="md-nav__link">
        General
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../r_cran/" class="md-nav__link">
        R
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../readings/" class="md-nav__link">
        Books
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../unix/" class="md-nav__link">
        Unix command learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../website/" class="md-nav__link">
        Website \[3/3\]
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#server-blocks" class="md-nav__link">
    Server blocks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root-directive" class="md-nav__link">
    Root directive
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-file-distribution-through-alias" class="md-nav__link">
    Static file distribution through alias
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-pass" class="md-nav__link">
    Proxy pass
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regex-path" class="md-nav__link">
    Regex path
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-source-folder" class="md-nav__link">
    Multiple source folder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    HTTPS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#websocket" class="md-nav__link">
    Websocket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also-generated" class="md-nav__link">
    See also (generated)
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="nginx">nginx<a class="headerlink" href="#nginx" title="Permanent link">&para;</a></h1>
<p>This is a quick reminder about a few tricks in nginx. For me, nginx is
the tools that solves the question:</p>
<ul>
<li>How can I serve multiple web apps from a single server with a common
    root?</li>
<li>How can I serve multiple domain from the same server?</li>
</ul>
<p>Usually, the nginx root folder is stored under <code>/etc/nginx</code>. Note that
adaptation (usually path) might be required between linux distributions.</p>
<p>First of all, when you distribute multiple web app, it is much easier if
you can have multiple domain names: web apps will have their routes and
avoid paths conflict. In this case you will create <strong>server block</strong> for
each domain.</p>
<p>Tips: pay attention to the slashes (<code>/</code>) it the path, as nginx mainly
concatenate strings, so you might accidentally have double slashes in
your path which usually leads to unintended consequence.</p>
<h2 id="server-blocks">Server blocks<a class="headerlink" href="#server-blocks" title="Permanent link">&para;</a></h2>
<p>Server blocks usually lives in the <code>conf.d</code> or <code>sites-availables</code></p>
<div class="highlight"><pre><span></span><code>server {
        listen 80;
        listen [::]:80;

        root /var/www/your_domain/html;
        index index.html index.htm index.nginx-debian.html;

        server_name your_domain www.your_domain;

        location / {
                try_files $uri $uri/ =404;
        }
}
</code></pre></div>
<p>where <code>your_domain</code> is replaced by the domain you own. The <code>root</code>
directive provides the root of your web app, the folder needs to be
reachable by the process which started nginx. If the server block is
defined in <code>sites-availables</code>, you need to create a symlink into the
<code>sites-enabled</code> folder.</p>
<h2 id="root-directive">Root directive<a class="headerlink" href="#root-directive" title="Permanent link">&para;</a></h2>
<p>The root directive provides the root path of your request. In the
previous server block, the response from <code>nginx</code> to the request on the
path <code>www.your_domain/css/file.css</code> will be the filer located under
<code>/var/www/your_domain/html/css/file.css</code>, because
<code>/var/www/your_domain/html</code> was defined as the root and <code>/css/file.css</code>
is the path requested. If the files does not exists, the
<code>404 (not found)</code> answer is returned.</p>
<p>Nginx has concatenated the root with the path.</p>
<p>You can change the root for each <code>location</code> directive, which can handy
for distribution under several folders (see later).</p>
<h2 id="static-file-distribution-through-alias">Static file distribution through alias<a class="headerlink" href="#static-file-distribution-through-alias" title="Permanent link">&para;</a></h2>
<p>Usually, you desire to use some path of your domain to target different
folder because they serve the files for your webapp. Most webapp are
defined as if they were placed on the root folder, so if the web app is
distributed under <code>/my_webapp</code> the associated assets files (javascript,
css, images) will usually be unfound. To solve this problem, we use the
<strong>alias</strong> directive. In a server block (the default or any other), the
following directive will alias the <code>www.your_domain/my_webapp</code> to
<code>/var/www/my_webapp/html</code>.</p>
<div class="highlight"><pre><span></span><code>location /my_webapp {
    alias /var/www/my_webapp/html;
}
</code></pre></div>
<p>The consequences are that nginx will answer to request
<code>www.your_domain/my_webapp/css/file.css</code> with the file
<code>/var/www/my_webapp/html/css/files.css</code>, concatenating the alias and the
path. If root instead of alias was used, nginx would have returned
<code>/var/www/my_webapp/html/my_webapp/css/file.css</code>, because nginx always
append the full path to the route, whereas alias replace the the match
path with the value provided to alias.</p>
<p>In my personal experience, you will use and abuse <strong>alias</strong> more often
than root.</p>
<h2 id="proxy-pass">Proxy pass<a class="headerlink" href="#proxy-pass" title="Permanent link">&para;</a></h2>
<p>When creating web apps, you will often create a backend server. This
server will usually be connected to some port under root (e.g. 8000,
8050, 8081). Under development, you will often use <code>localhost:8050</code> as
domain. In production, you will launch the same program which will still
listen to the same port. However, you want your user to call a path on
<code>your_domain</code>. The <strong>proxy<sub>pass</sub></strong> directive is the solution to
this problem.</p>
<div class="highlight"><pre><span></span><code>location /backend_path {
    proxy_pass locahost:8050;
}
</code></pre></div>
<p>Hence the for each request called to <code>my_domain//backend_path/data</code>, the
backend will match it to <code>/data</code>.</p>
<p>Obviously you can use <strong>nginx</strong> to also perform some indirection</p>
<div class="highlight"><pre><span></span><code>location /backend_path/x {
    proxy_pass locahost:8050/y;
}
</code></pre></div>
<p>In this case, under the request <code>my_domain//backend_path/x/data</code>, the
backend will return the handler registered under the route <code>/y/data</code>.</p>
<h2 id="regex-path">Regex path<a class="headerlink" href="#regex-path" title="Permanent link">&para;</a></h2>
<p>Regex can be used to match multiple paths in nginx. You start a regex
path by adding a tilde <code>~</code> sign after location and then using standard
regex notation to reuse the match parts.</p>
<div class="highlight"><pre><span></span><code>location ~ /images/(.+)$ {
  try_files /other_images_folders/$1 =404;
}
</code></pre></div>
<h2 id="multiple-source-folder">Multiple source folder<a class="headerlink" href="#multiple-source-folder" title="Permanent link">&para;</a></h2>
<p>It might happens that your apps call the same path, but the content is
located in different folder. In this case, we can combine root and regex
to sovle the issue.</p>
<div class="highlight"><pre><span></span><code>location ~ /images/(.+)$ {
  root /var/www;
  try_files /my_webapp/images/$1 /your_domain/images/$1 =404;
}
</code></pre></div>
<p>Here nginx will try to server <code>/images/file.jpeg</code> from
<code>/my_webapp/images/file.jpeg</code> before <code>/your_domain/images/file.jpeg</code>.</p>
<h2 id="https">HTTPS<a class="headerlink" href="#https" title="Permanent link">&para;</a></h2>
<p>In order to promote the connection to https, you will need to change the
server blocks and define the path of your certificates.</p>
<div class="highlight"><pre><span></span><code>server {
    listen              443 ssl;
    server_name         www.example.com;
    ssl_certificate     path/to/www.example.com.crt;
    ssl_certificate_key path/to/www.example.com.key;
    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers         HIGH:!aNULL:!MD5;
}
</code></pre></div>
<p>Usually, you will want
<a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-18-04">letsencrypt</a>
(if you own the domain name) to save this for you.</p>
<h2 id="websocket">Websocket<a class="headerlink" href="#websocket" title="Permanent link">&para;</a></h2>
<p>In order to allow websocket, you must <strong>upgrade</strong> the connection. For
this you can adapt the following snippet under the desired location:</p>
<div class="highlight"><pre><span></span><code>location /shadow-cljs/ {
  # upgrade to websocket
  proxy_pass http://localhost:9630/;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection &quot;Upgrade&quot;;
  proxy_set_header Host $host;
}
</code></pre></div>
<h2 id="links">Links<a class="headerlink" href="#links" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://nginx.org/en/">https://nginx.org/en/</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-20-04">Digital ocean
    guide</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-dns-terminology-components-and-concepts">An Introduction to DNS Terminology, Components, and
    Concepts</a></li>
</ul>
<h2 id="see-also-generated">See also (generated)<a class="headerlink" href="#see-also-generated" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../devops/">Devops</a></li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../20200505112138-clojure_reducers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Clojure Reducers" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Clojure Reducers
            </div>
          </div>
        </a>
      
      
        
        <a href="../20200505113402-high_performance_clojurescript/" class="md-footer__link md-footer__link--next" aria-label="Next: High Performance Clojurescript" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              High Performance Clojurescript
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (C) 2022 David Pham
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>